---
permalink: /feeds/main.json
eleventyExcludeFromCollections: true
---
{
  "version": "https://jsonfeed.org/version/1.1",
  "title": {{ title | dump | safe }},
  "home_page_url": {{ site.url | dump | safe }},
  "feed_url": {{ page.url | absoluteUrl(site.url) | dump | safe }},
  "description": {{ description | dump | safe }},
  "authors": [
    {
      "name": {{ site.author.name | dump | safe }},
      "url": {{ "https://mastodon.social/@tempertemper" | dump | safe }},
      "avatar": {{ (site.url + "/assets/img/martin-underhill-tempertemper--square-512x512.jpg") | dump | safe }}
    }
  ],
  "icon": {{ (site.url + "/assets/img/tempertemper-feed.png") | dump | safe }},
  "favicon": {{ (site.url + "/assets/img/icons/favicon.png") | dump | safe }},
  "items": [
  {%- for post in collections.post | reverse %}
    {%- set idx = loop.index0 -%}
    {%- set postUrl = (post.url | replace('.html','')) | absoluteUrl(site.url) -%}
    {%- set postTitle = post.data.title | smart | replace("&nbsp;"," ") | replace("&shy;","") | trim -%}
    {%- set postSummary = post.data.intro | markdown | striptags | trim -%}
    {%- set postTags = post.data.tags | tagsOnPage -%}
    {%- set body = post.templateContent -%}
    {%- set footer = '<p>The article <a rel="nofollow" href="' + postUrl + '">' + postTitle + '</a> appeared first on <a rel="nofollow" href="' + site.url + '">www.tempertemper.net</a>.</p>\n' -%}
    {%- set html = body + footer -%}
    {
      "id": {{ postUrl | dump | safe }},
      "url": {{ postUrl | dump | safe }},
      "title": {{ postTitle | dump | safe }},
      "summary": {{ postSummary | dump | safe }},
      {%- if postTags and postTags.length > 0 %}
      "tags": {{ postTags | dump | safe }},
      {%- endif %}
      "date_published": {{ post.date | dateToRfc3339 | dump | safe }},
      "date_modified": {{ ((post.data.updated or post.date) | bumpSeconds(idx)) | dateToRfc3339 | dump | safe }},
      "content_html": {{ html | renderTransforms(post.data.page, site.url) | dump | safe }}
    }{% if not loop.last %},{% endif %}
  {%- endfor %}
  ]
}
